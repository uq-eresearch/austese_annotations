/*
** Annotator 1.2.6-dev-169c845
** https://github.com/okfn/annotator/
**
** Copyright 2012 Aron Carroll, Rufus Pollock, and Nick Stenning.
** Dual licensed under the MIT and GPLv3 licenses.
** https://github.com/okfn/annotator/blob/master/LICENSE
**
** Built at: 2013-04-30 05:26:21Z
*/((function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};Annotator.Plugin.Private=function(b){function d(){this.updateViewer=a(this.updateViewer,this),this.updatePrivateField=a(this.updatePrivateField,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.events={beforeAnnotationCreated:"addFieldsToAnnotation"},d.prototype.pluginInit=function(){if(!Annotator.supported())return;return this.annotator.editor.addField({type:"checkbox",label:Annotator._t("Is Private"),load:createCallback("updatePrivateField"),submit:createCallback("updateAnnotationPrivate")}),this.annotator.viewer.addField({load:this.updateViewer})},d.prototype.updatePrivateField=function(a,b,c){var d;return b=Annotator.$(b).show(),d=b.find("input").removeAttr("disabled"),this.authorize("admin",c)||b.hide(),this.authorize(a,c||{},null)?d.attr("checked","checked"):d.removeAttr("checked")},d.prototype.updateViewer=function(a,b,c){a=Annotator.$(a);if(c){this.authorize("update",b)||c.hideEdit();if(!this.authorize("delete",b))return c.hideDelete()}},d.prototype.authorize=function(a,b,c){return c===void 0&&(c=this.user),this.options.userAuthorize?this.options.userAuthorize.call(this.options,a,b,c):!0},d}(Annotator.Plugin)})).call(this);